# 日報をエクセルシートで集計しよう！提出漏れもかんたんチェック<Badge text="一部GOLD限定" type="warning" />
![](/utility/icatch2.png)
[[toc]]
## たくさんの日報やチェックシートを1枚のエクセルシートで集計する
例えば10名から毎日、日報が提出されると1か月で200通を超えてしまいます。報告がルーチン化すると、「読み流す」だけのたんなる流れ作業になっていませんか？  
日報やチェックシートは、現場の生きた声です。ぜひとも有効に活用したいものです。  
NipoのCSVエクスポート機能を活用してみましょう。例えば日報に書かれた「売上高」や、「アポイント件数」「走行距離」などの数値データを1枚のエクセルシートにまとめることができます。
![1枚の日報にある売上高や仕入高といった値を集計する](/utility/u8.png)

### スタッフ毎の集計やソート程度ならエクセルを使わずに計算できます
集計ならそろばん10段のNipoにお任せ下さい。「願いましては〜」おっと、冗談です。でもフラッシュ暗算より高速で正確な集計ができます。どのように？まずは次の画像をご覧ください
![集計機能](/utility/u9.png)

仮に、この報告書には「売上」と「距離」と「件数」という３つの集計対象フィールドが存在するとします。（前章の「営業チェックシート」をそのまま使っています）  
１つの報告書に３つの集計対象があり、さらにこの報告書を４人のスタッフが毎日提出するとき、これをエクセルで集計するのはそれなりにエクセルに長けた知識が必要になります。  
しかしNipoならエクセルを使わずとも簡単に集計ができます。  
画像を注意深く見てほしいのですが、３つの集計項目それぞれに対し、４名のスタッフごとに集計して結果をランキング形式で表示している様子が伺えますね。  
さらに各項目の合計、そしてスタッフ１名あたりの平均、更に報告書の枚数１枚あたりの単価も算出します。  
集計期間についても自由に設定できます。この例は全期間で集計をしていますが、１週間ごとに集計をしたり、１ヶ月、３ヶ月、１年といった単位で集計も可能です。  

皆さんにとってどのような項目を集計したいのでしょうか？Nipoは集計四太郎によってある程度の集計は可能です。しかし、掛け算や引き算、その他独自の集計計算が必要な場合はNipoでは行えません。あくまでも決まった演算ルールに従って、集計をするだけです。  
では、独自の集計ルールをするにはどうすればよいのでしょうか？はい、ここでExcelを使います。

### 複数の日報をCSVダウンロードしてエクセルで開くまで
まず集計する日報のテンプレートと、集計の期間を選びます。
![日報を集計する-集計期間と集計するテンプレートを選びます](/utility/u10.png)
▼集計された結果が表示されます。集計後は「承認済み」や「棄却」「全て」といった日報の状態によって更に絞り込むことも可能です。  
絞り込みはリアルタイムで結果が変わります。オレンジで表示された「ダウンロード」ボタンをクリックしてください。
![集計後に条件を変更する]](/utility/u11.png)
ダウンロードされたファイルはnipo.csvという名前がデフォルトで付いています。さっそく開いてみましょう  
![集計された日報をダウンロードして、エクセルで開いたところ](/utility/u12.png)  
１件１件の日報を読むのと違い、一定期間の日報を一度に見ることができます。加えてエクセルの「並べ替え機能」や、「グラフ作成」を使えば、日報の集計も簡単です。  
パソコンにエクセルが入っていれば、ダウンロードしたファイルのアイコンがエクセルのアイコンになっているはずです。あとはエクセルで自由に集計してみましょう。  

::: tip CSV出力時の変化について
- 同一テンプレート内に同じ名前の項目名がある場合、衝突を回避するために便宜上の番号が割り振られる
- 集計項目が未入力時、エクセル上は空欄となる
- 画像・手描きイラストは出力されない
- レーティングは算用数字(0〜10)に置き換わる
- チェックボックスは、ON・OFFという文字に置き換わる
- 日付は、yyyy/mm/dd形式で文字として置き換わる（必要に応じてシリアル値へ変換して下さい）
- 時刻は24時間表記で文字として置き換わる
- 複数行テキストは、改行や文字の色、マスクなどの情報が除外される
:::

::: warning エクセルが文字化けした？
古いエクセルで開くと、Nipoのデータが文字化けしてしまうことがあります。（エクセル2007で確認）もし文字化けしてしまった場合は、一度エクセルを閉じてください。  
そして新しいエクセルファイル（新規作成）を開き、次の手順に従って作業してください  
![エクセルで開いたら文字化けした場合の対策](/utility/u13.png)
NipoからダウンロードしたCSVファイルを指定してください
![CSVの設定を選ぶ](/utility/u14.png)
最後にOKボタンをクリックします。これで文字化けが回避できます
:::

### 特定のスタッフの日報だけをCSVエクスポートできます
前述したやり方ではすべてのスタッフの日報をCSVエクスポートしますが、特定のスタッフが書いた日報だけをCSVエクスポートすることができます
![選んだスタッフだけを選んでCSVに出力する]](/utility/u15.png)
１名だけダウンロードする際は、名前の横にあるダウンロードボタンをクリックしてください。１名の場合ダウンロードされるファイル名は「スタッフ名.csv」となります。
複数名を一括でダウンロードする際は、ダウンロードしたいスタッフにチェックを入れ、下部にある「○名の日報をDL」ボタンをクリックします。ファイル名は「3名分日報セット.csv」（選んだ人数によって変化）となります

### 複数のCSVファイルを1つに統合する「CSVSC」のご紹介
![CSV連結ツールのご案内](/utility/u16.png)
CSVはそのままエクセルで開くことができ、集計や並べ替えなど便利に利用できますが、複数のCSVを1つのエクセルシートにまとめる機能はありません。ということでNipo公式のCSV結合システムを無償で公開しております。詳しくはCSVSCの紹介に譲りますが、一言で言うと  
**「複数のCSVファイルをドラッグ操作で1個のCSVに変換するWebシステム」**です。

## Nipo上でも集計やグラフが作れます
エクセルによる集計は非常に便利です。使い慣れた方にとっては、エクセルでさまざまな角度から日報を集計できます。でももっと手軽に日報や、チェックシートの状況を確認することもできます。日報の集計や、提出状況の確認、かんたんなグラフ化であればNipoにお任せください。Nipoで集計をするには、最初に集計の条件を指定します。

### スタッフの一人をくわしく分析する「期間推移」
あるスタッフの日報やチェックシートから数値データを抜き出してグラフ化、データテーブル化できます。まずは分析したいスタッフを選んでください。あとは全部Nipoがグラフ化・データテーブル化します
![日報のデータを集計して折れ線グラフを描画する](/utility/u17.png)
前述したエクセルによる日報分析でも同様のことが行なえますが、フィルタリングやソートなどの機能を使う必要があり、最低限のエクセルを捜査するスキルが必要です。しかしNipoを使えばこんなにかんたんにデータを分析できます。
::: tip
- 提出された日報の集計項目が未入力だった場合、値0として集計され、データテーブル上は0と記載されます
- 集計は日報のテンプレート毎に行われます。(テンプレートAとテンプレートBに同じ集計項目名があってもそれらは別々の項目として集計されます)
- 同じ日付で複数の日報を提出した場合、合算されて表示されます
- 小数点以下を扱う際は丸め誤差が生じる恐れがあります
- 集計項目の補助項目はグラフ化されません。将来のバージョンアップによってサポート予定です
:::

### スタッフ全員を一度に比較する「期間累計」
条件で指定された期間の合計値をグラフ化します。１日１日の細かい動きはわかりませんが、期間中の合計を見ることで全体の成績を大まかに把握可能です
![日報のデータを集計して、棒グラフを描画する](/utility/u18.png)
こちらも、エクセルによる日報分析で同様のことが行なえます。簡易的な分析で足りるのであれば上記機能を使ってください。より細かく分析をしたい場合は、エクセルなどによる分析を行うべきです


### 提出簿を見て、日報やチェックシートの提出漏れをふせぐ
提出簿を見れば、日報やチェックシート（ここでは「営業チェックシート」でしたね）を出したスタッフ、出していないスタッフを把握できます
![日報の提出簿を見る](/utility/u19.png)
また、提出簿は日報受信BOXでも表示されますが、集計時の提出簿と少し機能が違います。
例えば集計の提出簿は「特定のテンプレートを使った日報の提出」だけを表示しますが、受信ボックスの提出簿は「全てのテンプレートを集計対象」としています

